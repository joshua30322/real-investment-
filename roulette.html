<!DOCTYPE html>
<html lang="sw">
<head>
  <meta charset="UTF-8" />
  <title>Roulette Game with Color Bet</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #222;
      color: white;
      text-align: center;
      padding: 40px;
    }

    .roulette-wheel {
      margin: 30px auto;
      width: 300px;
      height: 300px;
      border: 12px solid #fff;
      border-radius: 50%;
      background: conic-gradient(
        red 0deg 30deg,
        black 30deg 60deg,
        red 60deg 90deg,
        black 90deg 120deg,
        red 120deg 150deg,
        black 150deg 180deg,
        red 180deg 210deg,
        black 210deg 240deg,
        red 240deg 270deg,
        black 270deg 300deg,
        red 300deg 330deg,
        black 330deg 360deg
      );
      transition: transform 4s ease-out;
    }

    .pointer {
      width: 0;
      height: 0;
      border-left: 20px solid transparent;
      border-right: 20px solid transparent;
      border-bottom: 40px solid yellow;
      margin: 0 auto 20px auto;
    }

    button {
      margin-top: 20px;
      padding: 15px 30px;
      font-size: 18px;
      cursor: pointer;
      background: green;
      border: none;
      color: white;
      border-radius: 8px;
    }

    .result {
      margin-top: 20px;
      font-size: 22px;
      font-weight: bold;
      min-height: 50px;
    }

    input, select {
      padding: 10px;
      font-size: 16px;
      margin: 5px;
      border-radius: 6px;
      border: none;
    }

    .balance {
      font-size: 20px;
      margin-top: 15px;
      font-weight: bold;
      color: lightgreen;
    }
  </style>
</head>
<body>

  <h1>🎯 Roulette Game</h1>

  <div class="balance" id="balanceDisplay">Salio: Tsh 0</div>

  <div>
    <input type="number" id="betAmount" placeholder="Weka kiasi (Tsh)" />
    <select id="guessColor">
      <option value="">Chagua rangi</option>
      <option value="red">Red</option>
      <option value="black">Black</option>
    </select>
  </div>

  <div class="pointer"></div>
  <div class="roulette-wheel" id="wheel"></div>

  <button onclick="spin()">Spin</button>

  <div class="result" id="result">Weka kiasi, namba na rangi ya kubeti</div>

  <script>
    const wheel = document.getElementById("wheel");
    const result = document.getElementById("result");
    const balanceDisplay = document.getElementById("balanceDisplay");

    // Save initial balance if not exists
    if (!localStorage.getItem("balance")) {
      localStorage.setItem("balance", "10000");
    }

    function updateBalanceDisplay() {
      const balance = parseInt(localStorage.getItem("balance")) || 0;
      balanceDisplay.textContent = `Salio: Tsh ${balance.toLocaleString()}`;
    }

    // Map segments to colors exactly as conic-gradient
    // Each segment 30deg, total 12 segments: [0..11]
    const colors = [
      "red",    // 1 (0-30deg)
      "black",  // 2 (30-60)
      "red",    // 3
      "black",  // 4
      "red",    // 5
      "black",  // 6
      "red",    // 7
      "black",  // 8
      "red",    // 9
      "black",  // 10
      "red",    // 11
      "black"   // 12
    ];

    function spin() {
      const amount = parseInt(document.getElementById("betAmount").value);
      const guess = parseInt(document.getElementById("guessNumber").value);
      const guessColor = document.getElementById("guessColor").value;
      let balance = parseInt(localStorage.getItem("balance")) || 0;

      if (isNaN(amount) || isNaN(guess) || guess < 1 || guess > 12 || !guessColor) {
        result.textContent = "⚠️ Tafadhali jaza kiasi, namba (1-12) na chagua rangi";
        return;
      }

      if (amount > balance) {
        result.textContent = "❌ Kiasi ulichoweka kinazidi salio lako";
        return;
      }

      // Deduct bet immediately
      balance -= amount;
      localStorage.setItem("balance", balance);
      updateBalanceDisplay();

      // Spin animation
      let randomDeg = Math.floor(Math.random() * 360 + 720);
      wheel.style.transform = `rotate(${randomDeg}deg)`;

      let finalDeg = randomDeg % 360;
      let section = Math.floor(finalDeg / 30); // 0-11
      let number = section + 1;
      let color = colors[section];

      setTimeout(() => {
        let payout = 0;
        let message = `Namba ni ${number} na rangi ni ${color.toUpperCase()}. `;

        if (number === guess && color === guessColor) {
          payout = amount * 4;
          message += `🎉 Hongera! Umeshinda mara 4 ya bet: Tsh ${payout.toLocaleString()}`;
        } else if (number === guess) {
          payout = amount * 2;
          message += `👍 Namba sahihi! Umeshinda mara 2 ya bet: Tsh ${payout.toLocaleString()}`;
        } else if (color === guessColor) {
          payout = amount * 1.5;
          message += `👍 Rangi sahihi! Umeshinda mara 1.5 ya bet: Tsh ${payout.toLocaleString()}`;
        } else {
          message += `❌ Pole! Umepoteza bet yako ya Tsh ${amount.toLocaleString()}`;
        }

        if (payout > 0) {
          balance += payout;
          localStorage.setItem("balance", balance);
          updateBalanceDisplay();
        }

        result.innerHTML = message;
      }, 4000);
    }

    updateBalanceDisplay(); // show balance on page load
  </script>
</body>
</html>